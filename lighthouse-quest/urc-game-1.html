<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Тайна Маяка — Текстовый квест</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100dvh;
            overflow: hidden;
            background-color: #12151a;
        }

        #game-container {
            width: 100vw;
            height: 100dvh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        svg {
            display: block;
            width: 100%;
            height: 100%;
            touch-action: none;
        }

		#room_desc, #room_title {
			/* Запрещаем браузеру самовольно менять размер шрифта */
			text-size-adjust: none;
			-webkit-text-size-adjust: none;
		}

		#room_desc {
			/* Увеличиваем межстрочный интервал для читабельности на малых экранах */
			line-height: 1.6 !important; 
		}
    </style>
</head>
<body>

    <div id="game-container">
        <svg id="game-svg" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice">
            <rect id="bg" x="-2000" y="-2000" width="4000" height="4000" fill="#12151a" />
            
            <g id="ui-layer">
                <rect id="ui-plate" fill="rgba(10, 10, 10, 0.95)" stroke="#333" stroke-width="1" />
                <foreignObject id="ui-text-box">
                    <div xmlns="http://www.w3.org/1999/xhtml" style="color: #b0b0b0; font-family: 'Verdana', sans-serif; line-height: 1.4; user-select: none;">
                        <strong id="room_title" style="display: block; color: #fff; border-bottom: 2px solid #444; text-transform: uppercase;">ЛОКАЦИЯ</strong>
                        <div id="room_desc">Загрузка...</div>
                    </div>
                </foreignObject>
                <g id="choices"></g>
            </g>
        </svg>
    </div>

    <script>
    window.addEventListener('load', () => {
        
		// 1. Настройка размеров (делаем это сразу)
		const svg = document.querySelector('svg');
		const updateLayout = () => {
			const container = document.getElementById('game-container');
			const w = container.clientWidth;
			const h = container.clientHeight;
			
			const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
			const isLandscape = w > h;
	
			svg.setAttribute("viewBox", `0 0 ${w} ${h}`);
			
			const plate = document.getElementById('ui-plate');
			const textBox = document.querySelector('foreignObject');
			const choicesG = document.getElementById('choices');

			if (plate && textBox && choicesG) {
				// В горизонтальном режиме панель занимает 70% высоты, но она сама меньше
				// В вертикальном оставляем 15% снизу под навигацию телефона
				const uiHeight = isLandscape ? h * 0.8 : h * 0.5;
				const safeMargin = isLandscape ? 10 : 60; // Отступ снизу
				const uiY = h - uiHeight - safeMargin;
				
				plate.setAttribute("width", w);
				plate.setAttribute("height", uiHeight + 200);
				plate.setAttribute("y", uiY);

				// Текстовая область
				textBox.setAttribute("x", 20);
				textBox.setAttribute("y", uiY + 15);
				textBox.setAttribute("width", w - 40);
				textBox.setAttribute("height", isLandscape ? uiHeight * 0.4 : uiHeight * 0.5);
				
				// Смещаем кнопки: в Landscape они выше, в Portrait ниже
				const buttonsY = h - safeMargin - (isLandscape ? uiHeight * 0.4 : uiHeight * 0.35);
				choicesG.setAttribute("transform", `translate(20, ${buttonsY})`);

				// Перерисовываем кнопки при изменении экрана
				if (typeof currentStateId !== 'undefined') renderRoom(currentStateId);
			}
		}

		updateLayout();
		window.addEventListener('resize', updateLayout);

		function createButton(text, index) {
			const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
			g.setAttribute("cursor", "pointer");

			const container = document.getElementById('game-container');
			const screenW = container.clientWidth;
			const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
			const isLandscape = screenW > container.clientHeight;
			
			const fontSize = (!isLandscape && isMobile) ? "24px" : "16px";
		
			// В вертикальном режиме - 1 колонка (на всю ширину)
			// В горизонтальном - 2 колонки
			const colCount = isLandscape ? 2 : 1;
			const btnWidth = (screenW - 40 - (colCount - 1) * 10) / colCount;
			const btnHeight = isLandscape ? 35 : 45; // В горизонте кнопки чуть ниже
			
			const x = (index % colCount) * (btnWidth + 10);
			const y = Math.floor(index / colCount) * (btnHeight + 8);

			g.innerHTML = `
				<rect x="${x}" y="${y}" width="${btnWidth}" height="${btnHeight}" rx="6" fill="#1e2229" stroke="#555" stroke-width="1.2"/>
				<text x="${x + btnWidth/2}" y="${y + (btnHeight/2 + 5)}" text-anchor="middle" fill="#fff" font-family="Verdana" font-size="${fontSize}" font-weight="bold">${text}</text>
			`;
			return g;
		}

		function renderRoom(id) {
			window.currentStateId = id;
			if (state.isEventActive) return;
			const room = rooms[id] || rooms["start"];
			const titleEl = document.getElementById('room_title');
			const descEl = document.getElementById('room_desc');
			const btnGroup = document.getElementById('choices');

// set fonts
			const container = document.getElementById('game-container');
			const screenW = container.clientWidth;
			const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
			const isLandscape = screenW > container.clientHeight;
//			const fontSize = (!isLandscape && isMobile) ? "24px" : "16px";
			descEl.style.fontSize = isMobile ? "24px" : "16px";
			titleEl.style.fontSize = !isLandscape ? "24px" : "16px";

			if (titleEl && descEl && btnGroup) {
				titleEl.textContent = room.title;
				descEl.innerHTML = (typeof room.desc === 'function' ? room.desc() : room.desc);
				btnGroup.innerHTML = "";
				
				room.choices().forEach((choice, i) => {
					const btn = createButton(choice.text, i);
					btn.onclick = () => {
						if (choice.action) choice.action();
						renderRoom(choice.next);
					};
					btnGroup.appendChild(btn);
				});
				
				if (room.action) room.action();
				
				// Важно: вызываем пересчет координат после отрисовки кнопок
				if (typeof updateLayout === 'function') {
					setTimeout(updateLayout, 10); 
				}
			}
		}

		// 2. Инициализация игры
		let state = {
			hasLamp: false,
			hasPin: false,
			pinInstalled: false,
			hasTweezers: false,
			knowsAboutStone: false,
			seenThroughWindow: false,
			doorOpened: false,
			inspectCount: 0,
			heardScream: false,
			isEventActive: false,
			hasAxe: false,
			girlFreed: false,
			isPursued: false,
			enemyBlinded: false
		};

		const rooms = {
		  "start": {
			title: "Обломки каюты",
			get desc() { 
			  let d = "Каюта медленно наполняется сыростью. ";
			  if (!state.hasLamp) d += "Среди разбитого стекла видна лампа. ";
			  if (!state.hasPin) d += "В углу, из искореженного механизма лебедки, торчит стальной штырь.";
			  else d += "Механизм лебедки теперь выглядит бесполезным остовом.";
			  return d;
			},
			choices: () => {
			  let c = [];
			  if (!state.hasLamp) {
				c.push({ 
				  text: "Взять лампу", 
				  action: () => { state.hasLamp = true; }, 
				  next: "start" 
				});
			  }

			  if (!state.hasPin) {
				c.push({ 
				  text: "Выдернуть штырь", 
				  action: () => { state.hasPin = true; }, 
				  next: "start" 
				});
			  }
			  c.push({ text: "Выбраться наружу", next: "deck" });
			  return c;
			}
		  },
		  "wall_inspect": {
			title: "Гранитные стены",
			get desc() {
				if (state.pinInstalled) return "Штырь надежно сидит в стене. Теперь можно взобраться выше, к узкому окну.";
				return "В растворе зияет глубокая узкая щель. Она кажется достаточно прочной, если вставить в неё что-то подходящее.";
			},
			choices: () => {
			  let c = [];
			  if (state.hasPin && !state.pinInstalled) {
				c.push({ text: "Вставить штырь в щель", action: () => { state.pinInstalled = true; }, next: "wall_inspect" });
			  }
			  if (state.pinInstalled) {
				c.push({ text: "Взобраться к окну", next: "window_view" });
			  }
			  c.push({ text: "Вернуться назад", next: "backyard" });
			  return c;
			}
		  },
		  "window_view": {
			title: "Узкое окно",
			desc: "Вы дотягиваетесь до окна. Сквозь мутное стекло вы видите девушку, прикованную к стене. Она вас не видит, но вы слышите её дыхание.",
			choices: () => [
			  { text: "Постучать в стекло", next: "window_interact" },
			  { text: "Спуститься вниз", next: "wall_inspect" }
			]
		  },
		  "window_interact": {
			title: "Первый контакт",
			get desc() {
				return "Ваш стук заставил её вздрогнуть. " + 
				(state.knowsAboutStone 
				  ? "Она всё еще дрожащим пальцем указывает вниз, на порог. В её глазах — мольба и ужас." 
				  : "Она указывает пальцем вниз, туда, где за стеной находится порог внешней двери. Кажется, она хочет, чтобы вы что-то там нашли.");
			},
			action: () => { 
				state.seenThroughWindow = true; 
				state.heardScream = true;
			},
			choices: () => {
			  let c = [];
			  if (!state.knowsAboutStone) {
				  c.push({ text: "Шепотом спросить: «Кто здесь?»", next: "window_whisper", action: () => { state.knowsAboutStone = true; } });
			  }
			  else {
				  c.push({ text: "Попытаться разбить стекло", next: "window_fail" });
			  }
	//	      c.push({ text: "Спуститься к порогу", next: "door_inspect", action: () => { state.knowsAboutStone = true; } });
			  c.push({ text: "Спуститься вниз", next: "wall_inspect" });
			  return c;
			}
		  },
		  "window_whisper": {
			title: "Опасный шепот",
			desc: "Девушка бледнеет и выдыхает: «Он... скоро вернется... ищите под камнем у порога...». Сверху доносится тяжелый глухой звук шагов.",
			action: () => { 
				state.knowsAboutStone = true; 
				state.heardScream = true; 
			},
			choices: () => [
				{ text: "Опомниться и спуститься", next: "wall_inspect" },
				{ text: "Заглянуть внутрь", next: "death_curiosity" }
			]
		  },
		  "window_fail": {
			title: "Роковая ошибка",
			desc: "Вы бьете кулаком в стекло. Гулкий звук разносится по маяку. Девушка в ужасе закрывает лицо руками. Сверху раздается рев, и через секунду в окне появляется массивная тень преследователя. Бежать уже поздно.",
			choices: () => [{ text: "Начать заново", action: () => location.reload() }]
		  },
		  "death_curiosity": {
			title: "Фатальное любопытство",
			desc: "Вы заглядываете внутрь. Девушка вжимается в стену. Внезапно огромная тень перекрывает свет, и тяжелый сапог бьет в решетку прямо перед вашим лицом. Вы теряете равновесие и летите вниз на острые камни...",
			choices: () => [{ text: "Начать заново", action: () => location.reload() }]
		  },
		  "door_shoulder": {
			title: "Грубая сила",
			desc: "Вы с разбега бьете плечом в дверь. Железо даже не дрогнуло, но по башне разнесся гулкий эхо-сигнал. Кажется, кто-то наверху перестал стучать и теперь прислушивается...",
			choices: () => [{ text: "Затаиться", next: "door_inspect" }]
		  },
		  "door_inspect": {
			title: "Железная дверь",
			get desc() {
				if (state.doorOpened) return "Тяжелая дверь приоткрыта. Изнутри тянет холодом и сыростью.";
				if (state.hasTweezers) return "Вы стоите перед замком с пинцетом. Нужно вытащить обломок.";
				if (state.knowsAboutStone) return "Вы знаете, что под порогом что-то спрятано. Нужно только нагнуться и поискать.";
				if (!state.hasLamp) return "Перед вами массивная преграда. Здесь слишком темно.";
				if (state.heardScream || state.seenThroughWindow) return "Вы знаете, что внутри кто-то есть. Каждая секунда на счету.";
				if (state.inspectCount === 1) return "Внутри скважины плотно засел кончик ключа. Пальцами его не достать.";
				return "Тяжелая дверь маяка закрыта наглухо.";
			},
			choices: () => {
			  let c = [];
			  if (!state.doorOpened) {
				  if (state.hasTweezers) c.push({ text: "Использовать пинцет", next: "unlocking" });
				  if (state.knowsAboutStone && !state.hasTweezers) c.push({ text: "Обыскать порог", next: "door_threshold_search" });
				  if (state.hasLamp && !state.heardScream) {
					c.push({ 
						text: "Присмотреться к замку", 
						action: () => { 
							state.inspectCount++; 
						}, 
						// Используем функцию для определения пути:
						next: state.inspectCount + 1 >= 2 ? null : "door_inspect"
					});
				  }
				  c.push({ text: "Ударить плечом", next: "door_shoulder" });
			  } else {
				  c.push({ text: "Войти внутрь", next: "entrance" });
			  }
			  c.push({ text: "Отойди от двери", next: "deck" });
			  return c;
			}
		  },
		  "door_threshold_search": {
			title: "Порог двери",
			desc: "Вы шарите руками под порогом. Пальцы натыкаются на что-то холодное в промасленной тряпке.",
			choices: () => [{ text: "Достать сверток", next: "get_tweezers", action: () => { state.hasTweezers = true; } }]
		  },
		  "get_tweezers": {
			title: "Тонкий инструмент",
			desc: "В свертке — стальной пинцет и записка: «Прости». Теперь вы можете вытащить обломок!",
			action: () => { state.hasTweezers = true; },
			choices: () => [{ text: "К замку!", next: "door_inspect" }]
		  },
		  "unlocking": {
			title: "Замок поддается",
			desc: "Пинцет цепляет металл. Клик! Обломок выпадает. Дверь со скрипом открывается.",
			action: () => { state.doorOpened = true; },
			choices: () => [{ text: "Войти внутрь", next: "entrance" }]
		  },
		  "entrance": {
			title: "Вестибюль",
			desc: "Внутри темно. Винтовая лестница уходит вверх. Слышны шаги на верхних этажах.",
			choices: () => [
				{ text: "Искать оружие внизу", next: "search_lobby" },
				{ text: "Тихо идти вверх", next: "stairs" }
			]
		  },
		  "deck": {
			title: "Подножие маяка",
			desc: "Вы на скалистом выступе. Рядом дверь, впереди — обход вокруг башни.",
			choices: () => [
			  { text: "Вернуться в обломки", next: "start" },
			  { text: "К железной двери", next: "door_inspect" },
			  { text: "Обойти маяк", next: "backyard" }
			]
		  },
		  "backyard": {
			title: "Задний двор",
			desc: "Тропа обрывается. Здесь только гранитные стены.",
			choices: () => [
			  { text: "Вернуться к дверям", next: "deck" },
			  { text: "Осмотреть кладку", next: "wall_inspect" }
			]
		  },
		  "search_lobby": {
			title: "Каморка смотрителя",
			get desc() {
				let d = "Маленькая комната, забитая хламом. На стене висит пустой пожарный щит, а под ним — тяжелый железный ящик. ";
				if (!state.hasAxe) d += "В углу вы замечаете старый пожарный топор с потрескавшейся рукоятью.";
				else d += "Место, где стоял топор, теперь пустует.";
				return d;
			},
			choices: () => {
			  let c = [];
			  if (!state.hasAxe) {
				  c.push({ 
					text: "Взять топор", 
					action: () => { 
						state.hasAxe = true; 
					}, 
					next: "search_lobby" 
				  });
			  }
			  c.push({ text: "Вернуться в вестибюль", next: "entrance" });
			  return c;
			}
		  },
		  "stairs": {
			title: "Винтовая лестница",
			get desc() {
				let d = "Ступени круто уходят вверх. Тьма здесь кажется почти осязаемой. ";
				if (state.hasLamp) d += "Света вашей лампы едва хватает, чтобы видеть следующий шаг. ";
				d += "Где-то наверху раздается ритмичный стук... *тук-тук... тук-тук*... словно кто-то мерно бьет по трубе.";
				return d;
			},
			choices: () => [
			  { text: "Подниматься выше", next: "stairs_landing" },
			  { text: "Спуститься в вестибюль", next: "entrance" }
			]
		  },

		  "stairs_landing": {
			title: "Лестничная площадка",
			desc: "Вы замираете. На этом этаже две двери. Одна ведет в жилой отсек, откуда вы слышали голос девушки. Другая — массивная, дубовая — ведет в технические помещения. Стук доносится именно оттуда.",
			choices: () => [
			  { text: "К жилому отсеку (к ней)", next: "girl_cell" },
			  { text: "К дубовой двери (на стук)", next: "engine_room" },
			  { text: "Назад на лестницу", next: "stairs" }
			]
		  },

		  "girl_cell": {
			title: "Жилой отсек",
			get desc() {
				if (state.girlFreed) return "Комната пуста, цепи брошены на пол. Вам нужно уходить, пока ОН не преградил путь к выходу.";
				if (state.enemyBlinded) return "Девушка в ужасе смотрит на дверь, но видя вас, кричит: «Скорее, пока пар не рассеялся!»";
				return "Девушка вскрикивает, увидев вас. Её руки прикованы к стене старым ржавым замком. «Скорее! — шепчет она. — Он в машинном отделении, но это ненадолго!»";
	//	        return "Девушка прикована к стене. «Скорее! — шепчет она. — Он в машинном отделении!»";
			},
			choices: () => {
			  let c = [];
			  if (!state.girlFreed) {
				  // Использование топора для освобождения
				  if (state.hasAxe) {
					c.push({ 
						text: "Перерубить цепь топором", 
						action: () => { 
							state.girlFreed = true; 
							if (state.enemyBlinded) state.isPursued = true; 
						}, 
						next: "girl_cell" 
					});
				  }
				  c.push({ text: "Пытаться сорвать замок руками", next: "death_too_slow" });
			  } else {
				  c.push({ text: "Бежать к лестнице!", next: "chase_stairs" });
			  }
			  c.push({ text: "Назад в коридор", next: "stairs_landing" });
			  return c;
			}
		  },

		  "engine_room": {
			title: "Дубовая дверь",
			desc: "Вы осторожно приоткрываете тяжелую дверь. В центре комнаты, спиной к вам, стоит массивная фигура в окровавленном дождевике. Он мерно бьет тяжелым молотом по паровой трубе, не замечая вашего присутствия.",
			choices: () => [
			  { text: "Напасть на него (нужен топор)", next: state.hasAxe ? "attack_success" : "death_no_weapon" },
			  { text: "Тихо закрыть дверь", next: "stairs_landing" }
			]
		  },

	  /* --- ПРОИГРЫШНЫЕ ВЕТКИ --- */

		  "death_too_slow": {
			title: "Слишком медленно",
			desc: "Вы отчаянно дергаете цепь, теряя драгоценные секунды. Гулкий топот сапог за спиной раздается слишком поздно. Тяжелая рука ложится вам на плечо, и последнее, что вы видите — взмах стального молота...",
			choices: () => [{ text: "Начать заново", action: () => location.reload() }]
		  },

		  "death_no_weapon": {
			title: "Безрассудство",
			desc: "Вы бросаетесь на него с голыми руками. Гигант разворачивается с невероятной скоростью. Один короткий удар наотмашь отбрасывает вас к стене. Сознание гаснет под звук приближающихся шагов.",
			choices: () => [{ text: "Начать заново", action: () => location.reload() }]
		  },

		  "death_fall": {
			title: "Смертельный прыжок",
			desc: "В панике вы решаете, что прыжок в пролет лестницы — единственный шанс спастись. Но высота оказывается обманчивой. Тьма поглощает вас обоих прежде, чем вы успеваете осознать фатальность этого решения...",
			choices: () => [{ text: "Начать заново", action: () => location.reload() }]
		  },

		  "death_hidden": {
			title: "Загнанные в угол",
			desc: "Вы забиваетесь в узкую нишу для инструментов, затаив дыхание. Шаги затихают совсем рядом... А затем тяжелая рука сдирает занавеску. Его глаза светятся безумием в свете вашей лампы. Укрыться не удалось.",
			choices: () => [{ text: "Начать заново", action: () => location.reload() }]
		  },

		  "attack_success": {
			title: "Рискованный удар",
			get desc() {
				let d = "Вы делаете выпад топором. Лезвие вонзается в паровую трубу! Пар ослепляет гиганта. [cite: 71] ";
				if (state.girlFreed) {
					return d + "Вы хватаете девушку и бросаетесь прочь, пока Он ничего не видит! [cite: 72]";
				} else {
					return d + "Пока он дезориентирован, у вас есть шанс добежать до камеры и вызволить её!";
				}
			},
			action: () => { 
				state.enemyBlinded = true; // Враг временно не опасен
				if (state.girlFreed) {
					state.isPursued = true; 
				}
			},
			choices: () => {
				if (state.girlFreed) {
					return [{ text: "Бежать к лестнице!", next: "chase_stairs" }];
				} else {
					// Если она еще прикована, идем к ней [cite: 57, 58]
					return [{ text: "Бежать в жилой отсек!", next: "girl_cell" }];
				}
			}
		  },

	  /* --- ФИНАЛЬНЫЙ ПОБЕГ --- */
	  
		  "chase_stairs": {
			title: "Погоня!",
			desc: "Вы бежите по винтовой лестнице, поддерживая девушку. Сверху раздается яростный рев — Он обнаружил пропажу! Весь маяк содрогается от его тяжелого бега.",
			choices: () => [
			  { text: "Прыгнуть в пролет", next: "death_fall" },
			  { text: "Бежать в вестибюль", next: "final_dash" },
			  { text: "Спрятаться в нише стены", next: "death_hidden" }
			]
		  },

		  "final_dash": {
			title: "Последний рывок",
			get desc() {
			  let d = "Дверь маяка уже близко! Он почти настиг вас, вы чувствуете холодную ярость, исходящую от него. ";
			  if (state.hasAxe) d += "В последний момент вы вбегаете в проем и вбиваете пожарный топор в массивные петли двери, заклинивая её!";
			  else d += "Вы проскакиваете в дверной проем за долю секунды до того, как тяжелый молот опускается на то место, где вы только что стояли!";
			  return d;
			},
			choices: () => [{ text: "Бежать к скалам!", next: "victory" }]
		  },

		  "victory": {
			title: "На берегу",
			desc: "Вы падаете на холодные камни у самой воды. Девушка крепко сжимает вашу руку. Вы оглядываетесь на маяк: огромный черный палец, протыкающий небо. За дверью всё еще слышны удары... но Он уже не выйдет!",
			choices: () => [
			  { text: "Спросить её имя", next: "epilogue" }
			]
		  },
		  
		  "epilogue": {
			title: "Рассвет",
			get desc() {
				return "Она смотрит на светлеющий горизонт. — Меня зовут Элиза, — шепчет она. — Я ждала этого десять лет. Глядя на её запястья в шрамах, вы понимаете: шторм не был случайностью. Вы были здесь нужны.";
			},
			choices: () => [
			  { 
				text: "КОНЕЦ ИСТОРИИ", 
				next: "game_over_win"
			  }
			]
		  },

		  "game_over_win": {
			title: "ФИНАЛ",
			desc: "Поздравляем! Вы выбрались из маяка и спаслись.",
			choices: () => [
				{ text: "Играть снова", next: "the_end" }
			]
		  },

		  "the_end": {
			title: "БЛАГОДАРНОСТИ",
			desc: "<div style='text-align:center; margin-top:20px; font-style:italic; color:#fff;'>Вы прошли квест. <br/>Спасибо за участие в создании этой атмосферы!</div>",
			choices: () => [
				{ 
					text: "Играть снова", next: "start", action: () => { location.reload(); }
				}
			]
		  }

		};

		function triggerScream() {
			state.isEventActive = true;
			const desc = document.getElementById('room_desc');
			const btnGroup = document.getElementById('choices');
			desc.innerHTML = "<span style='color:#fff; font-weight:bold;'>ОГЛУШИТЕЛЬНЫЙ КРИК! <br/><br/>Женский голос, полный боли, разрывает тишину. Затем всё смолкает.</span>";
			btnGroup.innerHTML = "";
			const g = createButton("Опомниться...", 0);
			g.onclick = (e) => {
				if (e) e.stopPropagation();

				state.heardScream = true;
				state.isEventActive = false;

				window.currentStateId = "door_inspect"; 
				renderRoom("door_inspect");
			};
			btnGroup.appendChild(g);
		}

		// 4. СТАРТ
		renderRoom("start");
	});
</script>
</body>
</html>




